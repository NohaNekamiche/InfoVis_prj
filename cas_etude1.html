<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>cas d'étude 1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    

    <style type="text/css">
      svg {
        font: 10px sans-serif;
        shape-rendering: crispEdges;
      }
    
      .axis path,
      .axis line {
        fill: none;
        stroke: #000;
      }
     
      path.domain {
        stroke: none;
      }
     
      .y .tick line {
        stroke: #ddd;
      }
     

body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  text-align: center;
}

.navbar {
  overflow: hidden;
  background-color: #333;
  position: fixed;
  top: 15%;
  width: 100%;
}

.navbar a {
  float: left;
  display: block;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.navbar a:hover {
  background: #f1f1f1;
  color: black;
}

.navbar a.active {
  background-color: #0489aa;
  color: white;
}

.main {
  padding: 16px;
  margin-bottom: 30px;
}

      </style>
  </head>
  <body>
    <div class="navbar">
      <a href="cas_etude1.html" class="active">Cas d'étude 1</a>
      <a href="cas_etude2.html">Cas d'étude 2</a>
    
    </div>
    
    <div class="main">
      <h1>Projet InfoVis : Visualisation des données</h1>
      <p>Dans ce projet nous allons faire une évaluation des données des maladies chroniques 
        et du processus de  génération de visualisation
        etudié dans le module InfoVis.</p>
    </div>
    
    <h1>1ère Cas d'étude :</h1>
    <h3>Distribution des hommes et femmes fumeurs et/ou alcoolique selon  l'age</h3>
    <script>

      var data=[
  {
    "age": "18.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "3.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "7.0"
  },
  {
    "age": "19.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "1.0",
    "homme_non_fume_non_alcoo": "12.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "6.0"
  },
  {
    "age": "20.0",
    "homme_fum_alcoo": "1.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "4.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "5.0"
  },
  {
    "age": "21.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "8.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "6.0"
  },
  {
    "age": "22.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "2.0"
  },
  {
    "age": "23.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "2.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "2.0"
  },
  {
    "age": "24.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "25.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "2.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "26.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "4.0"
  },
  {
    "age": "27.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "3.0"
  },
  {
    "age": "28.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "29.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "2.0"
  },
  {
    "age": "30.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "2.0"
  },
  {
    "age": "31.0",
    "homme_fum_alcoo": "1.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "32.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "33.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "1.0",
    "homme_non_fume_non_alcoo": "2.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "34.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "35.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "36.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "37.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "1.0",
    "homme_non_fume_non_alcoo": "3.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "38.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "2.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "39.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "40.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "41.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "42.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "43.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "44.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "1.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "45.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "46.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "47.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "48.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "49.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "1.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "50.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "51.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "52.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "53.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "54.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "55.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "56.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  },
  {
    "age": "57.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "58.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "59.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "60.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "61.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "62.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "63.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "0.0"
  },
  {
    "age": "64.0",
    "homme_fum_alcoo": "0.0",
    "homme_fum_non_alcoo": "0.0",
    "homme_non_fume_non_alcoo": "0.0",
    "femme_fum_alcoo": "0.0",
    "femme_fum_non_alcoo": "0.0",
    "femme_non_fum_non_alcoo": "1.0"
  }
]

            var margin = {top: 20, right: 160, bottom: 35, left: 30};

        var width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

       
        var svg = d3.select("body")
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

            // Transposer les données en layers
      
 
       var dataset = d3.layout.stack()(["homme_fum_alcoo", "homme_fum_non_alcoo",
        "homme_non_fume_non_alcoo","femme_fum_alcoo","femme_fum_non_alcoo",
        "femme_non_fum_non_alcoo"
        ].map(function(population) {
          
          return data.map(function(d) {
    
             if (isNaN(d[population])) d[population]= 0;
             console.log(parseInt(+d[population]))
            return {x:parseInt(d.age), y: parseInt(+d[population])};
          });
        }));
        // Set x, y and colors
       
        var x = d3.scale.ordinal()
          .domain(dataset[0].map(function(d) { 
           
            
            return (d.x); }))
          .rangeRoundBands([0, width+25], 0.1);

        var y = d3.scale.linear()
          .domain([0, d3.max(dataset, function(d) {  return d3.max(d, function(d) { return d.y0 + d.y; });  })])
          .range([height, 0]);

        var colors = ["#17265D","#555E7B","#7CCCE5", 
        "#732B26","#E04644","#F2A0A0"];
        // Define and draw axes
        var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left")
        .ticks(5)
        .tickSize(-width, 0, 0)
        .tickFormat( function(d) { return d } );

        var xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom")
        .tickFormat(data.age); // change this to get x values to reflect new

        svg.append("g")
  .attr("class", "y axis")
  .call(yAxis);

svg.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")
  .call(xAxis);


// Create groups for each series, rects for each segment 
var groups = svg.selectAll("g.cost")
  .data(dataset)
  .enter().append("g")
  .attr("class", "cost")
  .style("fill", function(d, i) { return colors[i]; });

var rect = groups.selectAll("rect")
  .data(function(d) { return d; })
  .enter()
  .append("rect")
  .attr("x", function(d) { return x(d.x) ; })
  .attr("y", function(d) { 
    
    if (isNaN(d.y)) d.y= 0;
    if (isNaN(d.y0)) d.y0= 0;
    console.log(d.y0, d.y)
    return y(d.y0 + d.y); })
  .attr("height", function(d) { return y(d.y0) - y(d.y0 + d.y); })
  .attr("width", x.rangeBand())
  .on("mouseover", function() { tooltip.style("display", null); })
  .on("mouseout", function() { tooltip.style("display", "none"); })
  .on("mousemove", function(d) {
    var xPosition = d3.mouse(this)[0] - 15;
    var yPosition = d3.mouse(this)[1] - 25;
    tooltip.attr("transform", "translate(" + xPosition + "," + yPosition + ")");
    tooltip.select("text").text(d.y);
  });



        // Draw legend
        var legend = svg.selectAll(".legend")
        .data(colors)
        .enter().append("g")
        .attr("class", "legend")
        .attr("transform", function(d, i) { return "translate(30," + i * 19 + ")"; });
        
        legend.append("rect")
        .attr("x", width - 18)
        .attr("width", 18)
        .attr("height", 18)
        .style("fill", function(d, i) {return colors.slice().reverse()[i];});
        
        legend.append("text")
        .attr("x", width + 5)
        .attr("y", 9)
        .attr("dy", ".35em")
        .style("text-anchor", "start")
        .text(function(d, i) { 
            switch (i) {
            case 0: return "Femme-Non-Fumeur-Non-Alcoolique";
            case 1: return "Femme-Fumeur-Non-Alcoolique";
            case 2: return "Femme-Fumeur-Alcoolique";
            case 3: return  "Homme-Non-Fumeur-Non-Alcoolique";
            case 4:return "Homme-Fumeur-Non-Alcoolique";
            case 5: return     "Homme-Fumeur-Alcoolique";
        
       
        
            }
        });


        // Prep the tooltip bits, initial display is hidden
        var tooltip = svg.append("g")
        .attr("class", "tooltip")
        .style("display", "none");
            
        tooltip.append("rect")
        .attr("width", 30)
        .attr("height", 20)
        .attr("fill", "white")
        .style("opacity", 0.5);

        tooltip.append("text")
        .attr("x", 15)
        .attr("dy", "1.2em")
        .style("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("font-weight", "bold")
        .attr("fill", "black")


          
    </script>
  </body>
</html>